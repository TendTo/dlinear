%%%%%%%%%%%%%%%%%%%%%%%%
% Imports
%%%%%%%%%%%%%%%%%%%%%%%%
% \usepackage{minted} % Package for syntax highlighting (https://ctan.org/pkg/minted)
\usepackage[T1]{fontenc} % Standard package for selecting font encodings (https://ctan.org/pkg/fontenc)
\usepackage{color}
\usepackage{hyperref} % Extensive support for hypertext in LATEX (https://ctan.org/pkg/hyperref)
\usepackage{graphicx} % Enhanced support for graphics (https://ctan.org/pkg/graphicx). Should include EPS figures.
\usepackage{cite}
\usepackage{subfig}
\usepackage{geometry} % Change page size at any point
\usepackage[edges]{forest} % Drat tree like data structures (https://ctan.org/pkg/forest)
\usepackage{pgffor} % Loops in LaTeX (https://ctan.org/pkg/pgffor)
\usepackage{csvsimple} % Simple CSV file processing (https://ctan.org/pkg/csvsimple)
\usepackage{underscore} % Control the behaviour of "_" in text (https://ctan.org/pkg/underscore)
\usepackage{listings} % Typeset source code listings using LATEX (https://ctan.org/pkg/listings)
\usepackage[title]{appendix}
\usepackage{adjustbox}
\usepackage{tikz}
\usepackage{xspace}
\usepackage{wrapfig}
\usepackage{amsmath}
\usepackage{mathtools}
\usepackage{tikz}
\usepackage{algorithm}
\usepackage{algpseudocode}

%%%%%%%%%%%%%%%%%%%%%%%%
% Settings
%%%%%%%%%%%%%%%%%%%%%%%%
% \addto\extrasenglish{%
%     \providecommand*{\lstlistingautorefname}{List.}
%     % \renewcommand*{\listingscaption}{Code}
%     \renewcommand*{\equationautorefname}{Eq.}
%     \renewcommand*{\figureautorefname}{Fig.}
%     \renewcommand*{\chapterautorefname}{Chap.}
%     \renewcommand*{\sectionautorefname}{Sec.}
%     \renewcommand*{\subsectionautorefname}{Sub-sez.}
% }
\renewcommand\UrlFont{\color{blue}\rmfamily} % Change URL font
\urlstyle{rm} % Change URL style
\usetikzlibrary{arrows.meta} % Tikz library for arrows
\renewcommand{\algorithmicrequire}{\textbf{Input:}}
\renewcommand{\algorithmicensure}{\textbf{Output:}}

%%%%%%%%%%%%%%%%%%%%%%%%
% References
%%%%%%%%%%%%%%%%%%%%%%%%
% \addbibresource{resources.bib} %Import the bibliography file

%%%%%%%%%%%%%%%%%%%%%%%%
% Glossary
%%%%%%%%%%%%%%%%%%%%%%%%
% \makeglossaries
% \loadglsentries{glossary}

%%%%%%%%%%%%%%%%%%%%%%%%
% Minted
%%%%%%%%%%%%%%%%%%%%%%%%
% \setminted[solidity]{tabsize=2,breaklines,fontsize=\footnotesize}
% \setminted[typescript]{tabsize=2,breaklines,fontsize=\footnotesize}


%%%%%%%%%%%%%%%%%%%%%%%%
% Geometry
%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\framedtext}[1]{%
    \par%
    \noindent\fbox{%
        \parbox{\dimexpr\linewidth-2\fboxsep-2\fboxrule}{#1}%
    }%
}

%%%%%%%%%%%%%%%%%%%%%%%%
% Listings
%%%%%%%%%%%%%%%%%%%%%%%%
\definecolor{keywords}{HTML}{C586C0}
\definecolor{type}{HTML}{0000FF}
\definecolor{operator}{HTML}{569CD6}
\definecolor{comments}{HTML}{6a9955}
\definecolor{variable}{HTML}{9e9b00}
\definecolor{number}{HTML}{098658}
\definecolor{function}{HTML}{795E26}

\lstset{language=C++,
    basicstyle=\ttfamily\small,
    keywordstyle=\color{keywords}\ttfamily,
    stringstyle=\color{orange}\ttfamily,
    commentstyle=\color{comments}\ttfamily,
    morecomment=[l][\color{comments}]{\#}
}
\lstdefinelanguage{SMT2}{
    alsoletter=-, % Include dashes as letters
    sensitive=true,
    morekeywords={set-logic, declare-fun, assert, check-sat, get-model},
    morekeywords=[2]{Int, Bool, Real},
    morekeywords=[3]{and, or, not, imply, ite},
    morekeywords=[4]{a, b, c, d, e, f, g, h, i, j, k, l, m, n, o, p, q, r, s, t, u, v, w, x, y, z},
    morecomment=[l]{;},
    morestring=[b]",
}
\lstset{
    language=SMT2,
    basicstyle=\ttfamily\small,
    keywordstyle=\color{keywords},
    keywordstyle={[2]\color{type}},
    keywordstyle={[3]\color{operator}},
    keywordstyle={[4]\color{variable}},
    commentstyle=\color{comments},
    stringstyle=\color{orange},
    showstringspaces=false,
    tabsize=2,
    breaklines=true,
}
\lstdefinelanguage{mps}{
    alsoletter=-, % Include dashes as letters
    sensitive=true,
    morekeywords={NAME, ROWS, COLUMNS, RHS, RANGES, BOUNDS, BINARIES, GENERALS, ENDATA},
    morekeywords=[2]{N, L, E, G, UP, LO, FX, FR, MI, PL},
    morecomment=[l]{*},
    morestring=[b]",
}
\lstset{
    language=mps,
    basicstyle=\ttfamily\small,
    keywordstyle=\color{keywords},
    keywordstyle={[2]\color{type}},
    commentstyle=\color{comments},
    stringstyle=\color{orange},
    showstringspaces=false,
    tabsize=2,
    breaklines=true,
}
\lstdefinelanguage{bazel}{
    alsoletter=-, % Include dashes as letters
    sensitive=true,
    morekeywords={load, workspace, http_archive, cc_binary, cc_library, cc_test, cc_toolchain, cc_toolchain_suite, filegroup, genrule, package_group, package, sh_binary, sh_library, sh_test},
    morekeywords=[2]{glob},
    morecomment=[l]{\#},
    morestring=[b]",
}
\lstset{
    language=bazel,
    basicstyle=\ttfamily\small,
    keywordstyle=\color{keywords},
    keywordstyle={[2]\color{function}},
    commentstyle=\color{comments},
    stringstyle=\color{orange},
    showstringspaces=false,
    tabsize=2,
    breaklines=true,
}
\lstdefinelanguage{yacc}{
    alsoletter={\#, \%, -, _, :}, % Include dashes as letters
    morekeywords={\#include, \#define, \#ifdef, \#endif},
    morekeywords=[2]{% Bison keywords
            \%union, \%token, \%type, \%nonassoc, \%left, \%prec, \%right, \%start,
            \%grammar, \%pure_parser, \%define, \%expect, \%expect-rr, \%file, \%glr-parser,
            \%parse-param, \%parse-param-rr, \%skeleton, \%debug, \%output,
            \%locations, \%skeleton
        },
    morekeywords=[3]{% Bison variables
            , stringVal,
        }
    keywordstyle=\color{keywords}\bfseries,
    morecomment=[l][\color{comments}]{//}, % single-line comments
    morecomment=[s][\color{comments}]{/*}{*/}, % multi-line comments
    morestring=[b]",
    morestring=[b]',
}
\lstset{
    language=yacc,
    basicstyle=\ttfamily\small,
    keywordstyle=\color{keywords},
    keywordstyle={[2]\color{type}},
    keywordstyle={[3]\color{variable}},
    commentstyle=\color{comments},
    stringstyle=\color{orange},
    showstringspaces=false,
    tabsize=2,
    breaklines=true,
}
\lstdefinelanguage{flex}{
    alsoletter={\#, \%, -, _, :}, % Include dashes as letters
    morekeywords={\#include, \#define, \#ifdef, \#endif},
    morekeywords=[2]{% Bison keywords
            typedef
        },
    morekeywords=[3]{% Bison variables
            , stringVal,
        }
    keywordstyle=\color{keywords}\bfseries,
    morecomment=[l][\color{comments}]{//}, % single-line comments
    morecomment=[s][\color{comments}]{/***}{*/}, % multi-line comments
    morestring=[b]",
    morestring=[b]',
}
\lstset{
    language=flex,
    basicstyle=\ttfamily\small,
    keywordstyle=\color{keywords},
    keywordstyle={[2]\color{type}},
    keywordstyle={[3]\color{variable}},
    commentstyle=\color{comments},
    stringstyle=\color{orange},
    showstringspaces=false,
    tabsize=2,
    breaklines=true,
}

%%%%%%%%%%%%%%%%%%%%%%%%
% Remove chapter header
%%%%%%%%%%%%%%%%%%%%%%%%
% \titleformat{\chapter}[display]{\normalfont\bfseries}{}{0pt}{\Huge}
% \newpagestyle{mystyle}
% {\sethead[\thepage][][\chaptertitle]{}{}{\thepage}}
% \pagestyle{mystyle}
% \AddToHook{env/appendices/begin}{%
%     \titleformat{\chapter}{\normalfont\LARGE\bfseries}{Appendix \thechapter}{10pt}{}%
% }

%%%%%%%%%%%%%%%%%%%%%%%%
% PlantUML
%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\plantuml}[4][1]{
    \begin{figure}[h]
        \begin{adjustbox}{width=#1\textwidth,center}
            \input{#2}
        \end{adjustbox}
        \caption{#3}\label{dg:#4}
    \end{figure}
}

\newcommand{\wrapplantuml}[5][1]{
    \begin{wrapfigure}{#2}{#1\textwidth} %this figure will be at the right
        \centering
        \begin{adjustbox}{width=#1\textwidth,center}
            \input{#3}
        \end{adjustbox}
        \caption{#4}\label{dg:#5}
    \end{wrapfigure}
}

%%%%%%%%%%%%%%%%%%%%%%%%
% Equation caption
%%%%%%%%%%%%%%%%%%%%%%%%
\newcounter{eqcounter}
\newcommand{\eqcaption}[1]{
    {
            \medskip
            \centering
            \setcounter{eqcounter}{\theequation}
            Equation \theeqcounter: #1
            \addtocounter{eqcounter}{1}

            \vskip-0.5\baselineskip
            \noindent
        }
}

%%%%%%%%%%%%%%%%%%%%%%%%
% Common definitions
%%%%%%%%%%%%%%%%%%%%%%%%
\def\dlinear{\textit{dLinear}\xspace}
\def\pydlinear{\textit{pydLinear}\xspace}
\def\dlinearfive{\textit{dLinear5}\xspace}
\def\dlinearfour{\textit{dLinear4}\xspace}
\def\bazel{\textit{Bazel}\xspace}
\def\dreal{\textit{dReal4}\xspace}
\def\soplex{\textit{SoPlex}\xspace}
