\begin{algorithm}
    \caption{SMT adapted LP solver}\label{alg:theory-solver}
    \begin{algorithmic}
        \Require $A, b, l, u$ \\
        \qquad as defined in Section~\ref{sec:lp} over the extended relaxed problem~\eqref{eq:lp-extended}
        \Require $J, K, D$ as defined in this Section \\
        \qquad note that $\max(J) < \min(K) \le \max(K) < \min(D)$
        \Ensure Set of indexes of infeasible constraints $E$ or $\emptyset$
        \State $E \gets \text{LpSolve}(A, b, l, u, J, K, \emptyset)$ \Comment{Solve the LP problem without $\ne$ constraints}
        \If{$E \ne \emptyset$}
        \State \Return $E$
        \EndIf
        \State $V \gets \emptyset$ \Comment{Set of inverted $\ne$ constraints}
        \State $c \gets 0$ \Comment{Initialise the binary counter}
        \While{$c \le 2^{|D|}$}
        \State Let $C \in \{-1, 1\}^{|D|}$ be the binary representation of $c$ with $0$ replaced by $1$
        \State $C' \in \{-1, 1\}^{|J|+|K|+|D|} \gets \begin{bmatrix} 1^{|J|} & 1^{|K|} & C\end{bmatrix}$
        \State $A' \gets \begin{bmatrix}A_i \odot C'_i\end{bmatrix} \quad \forall i \in \{1, 2, \ldots, |J|+|K|+|D|\}$
        \State $E \gets \text{LpSolve}(A', b \odot C', l, u, J, K, D)$
        \If {$E = \emptyset$}
        \State \Return $\emptyset$
        \ElsIf {$|E \cap D| = 1$} \Comment{Invert the single $\ne$ constraint}
        \If {$E \cap D \subset V$}
        \State \Return $E \cup S_{E \cap D}$ \Comment{Both senses explanation}
        \EndIf
        \State $V \gets V \cup E \cap D$
        \State $S_{E \cap D} \gets E$
        \State \textbf{Continue}
        \EndIf
        \State $c \gets c + 1$
        \EndWhile
    \end{algorithmic}
\end{algorithm}
